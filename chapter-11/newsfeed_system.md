# 뉴스 피드 시스템 설계
## 1. 문제 이해 및 설계 범위 확정
뉴스 피드 시스템을 설계할 때, 최소 어떤 기능을 지원해야 하는지 파악해야 한다.


1. 모바일 앱을 위한 것인지, 웹을 위한 것인지? (or 둘 다?)
2. 주요 기능 (본인의 스토리 업로드, 친구 스토리 확인, 팔로우 등 이벤트 확인)
3. 뉴스 피드의 순서 (최신 포스트, topic score 등 가중치가 있는지)
4. 한 명의 사용자가 가지는 친구 (뉴스 피드에 표시해야하는 정도를 체크)
5. 트래픽 규모 (DAU 기준)
6. 피드에 올라오는 타입 (텍스트, 미디어 파일 - 이미지나 비디오)


---
## 2. 개략적 설계안 제시
### 피드 발행
- 사용자가 스토리를 포스팅하면 해당 데이터를 캐시와 DB에 기록
- 새 포스팅은 친구의 뉴스 피드에도 전송


### 뉴스 피드 생성
- 책의 예시는 뉴스 피드에 모든 친구의 포스팅을 시간 역순으로 모아서 만든다고 가정했다.


---
## 3. 상세 설계



---
## 4. Summary
- 이번 설계안은 뉴스 피드의 발행 & 생성 두 부분으로 나눠서 확인했다.
- 회사마다 독특한 제약이나 요구 조건을 줄 수 있기 때문에 그 부분을 잘 고려해서 설계해야 한다.
- 뉴스 피드는 특히 대규모 시스템으로 확장하는 역량이 필요하다.
    - 기술 선택 시 trade-off, 판단 근거를 잘 설명해야 한다.
    - 규모 확장성에 대해 논의하는 것이 좋다.


### 확장성 논의할 때 필요한 주제들
- DB 규모 확장 (수직적 vs 수평적)
- SQL vs NoSQL
- Master-Slave 다중화
- 복제본(replica)에 대한 읽기 연산
- 일관성 모델
- DB sharding
- Web 계층 stateless 로 운영하기
- 가능한 많은 데이터를 캐시할 방법
- 여러 데이터 센터를 지원할 방법
- MQ를 사용하여 컴포넌트 사이 결합도 느슨하게 하기
- 핵심 메트릭에 대한 모니터링
    - ex 1. 트래픽이 몰리는 시간대의 QPS
    - ex 2. 사용자가 뉴스 피드를 refresh 할 때 걸리는 지연 시간